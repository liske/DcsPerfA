<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
</head>
<body>
<h1>DataCore Performance Analyzer</h1>

Run: <select id="sel_run"/>

<div id="meta"/>
<input id="debug"/>

<script>
    var $rname;
    var $runs = { };
    var $meta = { };
    var $counters = { };

function init_run() {
    $('#meta').html("<p>Run: " + $runs[$rname] + "</p>");
    $('#debug').val( "Loadeds " + $rname );
}

$('#sel_run').change(function() {
    $('#sel_run option:selected').each(function() {
	$rname = $(this).text();
	if($rname in $counters) {
	    init_run();
	} else {
	    var p = ['raw', $rname, 'counters.json'];
	    $.getJSON(p.join('/'), function(data) {
		$counters[$rname] = data;
		init_run();
	    });
	}
    });
});

$.getJSON('raw/manifest.json', function(data) {
    $.each(data, function(key, val) {
	$('#sel_run').append($('<option>', {
	    value: key,
	    text: key,
	}));

	$runs[key] = val;

	var p = ['raw', key, 'meta.json'];
	$.getJSON(p.join('/'), function(data) {
	    $meta[key] = data;
	});
    });

    $('#sel_run').change();
});
</script>
</body>
